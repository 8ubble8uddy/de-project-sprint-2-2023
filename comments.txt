Вопросы:

* папка 01_dwh / файл script.sql / строка 6: 
    Не совсем понял фразу ниже со слова «Например ...»:
    «
    Да, нужно добавить очистку таблицы от данных.
    Это можно сделать через операторы DELETE, TRUNCATE или DROP. 
    Выбор в пользу того или иного оператора зависит от того сколько времени занимает удаление таблицы. 
    Например, если запись данных идёт 10 минут, то мы на 10 минут лишаемся данных и в таких случаях всё делают через темповую таблицу
    ».
    Можешь поподробней написать про взаимосвязь: удаление таблицы и записи данных.

* папка 01_dwh / файл script.sql / строка 112:
    В замечании ты написала, что можно упростить запрос.
    Можешь написать как это сделать?
    Или имеется ввиду просто убрать конструкцию WITH и сразу писать SELECT (как в представленном скрипте из теории)?


* P.S. Вопрос по теме, но более технический, в интернете никак не могу найти ответ, вдруг знаешь:
    Почему в DBEAVER когда создаешь временную таблицу она удаляется сразу после COMMIT. (автокоммит выключал)
    Даже если поставить специальное для этого условие "ON COMMIT PRESERVE ROWS", которое говорит не удалять времменную таблицу после COMMIT, а оставить в текущей сессии.
    Код: < CREATE TEMP TABLE table_name ON COMMIT PRESERVE ROWS AS ... >
    То есть в DBEAVER разницы нет между инструкциями "ON COMMIT PRESERVE ROWS" и "ON COMMIT DROP".
    А допустим в psql, эта разница присутсвует. 
    Т.е. в psql c условием "ON COMMIT PRESERVE ROWS" временная таблица не удаляется и живёт всю сессию, а с "ON COMMIT DROP" соответственно удаляется после COMMIT.
